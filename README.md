# DeepMove
PyTorch implementation of WWW'18  paper-DeepMove: Predicting Human Mobility with Attentional Recurrent Networks [link](https://dl.acm.org/citation.cfm?id=3178876.3186058)

Source Code: https://github.com/vonfeng/DeepMove

# Datasets
All datasets are open-source:
- Foursquare-NYC(2. NYC and Tokyo Check-in Dataset) https://sites.google.com/site/yangdingqi/home/foursquare-dataset
    - dataset_TSMC2014_NYC.txt: Raw data.
    - foursquare.pk: From source code.
    - foursquare_new.pk: Generated by codes/sparse_traces_NYC.py based on dataset_TSMC2014_NYC.txt

- Porto Taxi https://www.kaggle.com/c/pkdd-15-predict-taxi-service-trajectory-i/data
  - porto_checkin.txt: Generated by /data/dataprocess.ipynb based on raw data.
  - proto.pk: Generated by codes/sparse_traces.py based on porto_checkin.txt.

Please download the dataset in the releases and unzip them to the /data file folder.


# Requirements
- Python 3.8.0
- Pytorch 1.7.0
- Numpy 1.24.3

# Project Structure
- /codes
    - main.py
    - model.py # define models
    - sparse_traces.py # foursquare data preprocessing 
    - train.py # define tools for train the model
- /pretrain
    - /simple
        - res.m # pretrained model file
        - res.json # detailed evaluation results
        - res.txt # evaluation results
- /data # preprocessed Foursquare and Proto data (pickle file)
- /docs # paper and presentation file
- /resutls # the default save path when training the model

# Usage
1. Load a pretrained model:
   Foursquare dataset:
> ```python
> python ./code/main.py --pretrain=1 --data_name 'foursquare'
> ```
   Porto dataset:
> ```python
> python ./code/main.py --pretrain=1 --data_name 'porto'
> ```

The codes contain LSTM model. The parameter settings for these model can refer to their res.txt file.


2. Train a new model:
> ```python
> python ./code/main.py --pretrain=0 --data_name 'foursquare'
> ```

Other parameters (refer to main.py):
- for training: 
    - learning_rate, lr_step, lr_decay, L2, clip, epoch_max, dropout_p
- model definition: 
    - loc_emb_size, uid_emb_size, tim_emb_size, hidden_size, rnn_type, attn_type
    - history_mode: avg, avg, whole

